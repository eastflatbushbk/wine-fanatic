(this["webpackJsonpreact-rails-api-project-template-client"]=this["webpackJsonpreact-rails-api-project-template-client"]||[]).push([[0],{145:function(e,n,t){},153:function(e,n,t){"use strict";t.r(n);var c=t(0),i=t.n(c),r=t(29),a=t.n(r),o=(t(145),t(6)),l=t(12),s=t(10),j=t(222),u=t(225),d=t(224),b=t(223),O=t(218),h=t(208),g=t(221),f=t(77),x=t.n(f),m=t(23),p=t(1),v=function(e){var n=e.wine,t=Object(l.c)((function(e){return e.usersReducer})),c=t.loggedIn?Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(h.a,{title:"see reviews & details",children:Object(p.jsx)(g.a,{"aria-label":"see reviews",children:Object(p.jsx)(x.a,{})})})}):null;return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)("div",{children:Object(p.jsxs)(j.a,{sx:{maxWidth:345},children:[Object(p.jsx)(b.a,{sx:{height:300},image:n.img_url,title:"wine bottle",style:{width:"90%",float:"center"}}),Object(p.jsxs)(d.a,{children:[Object(p.jsx)(O.a,{gutterBottom:!0,variant:"h5",component:"div",children:n.name}),Object(p.jsx)(O.a,{variant:"body2",color:"text.secondary",children:n.region})]}),Object(p.jsx)(u.a,{children:Object(p.jsx)(m.b,{to:"/wines/".concat(n.id),children:c})})]})})})},y=t(213),w=t(226),_=t(227),S=function(){var e=Object(l.c)((function(e){return e.winesReducer}));return console.log(e),Object(p.jsx)(w.a,{m:10,children:Object(p.jsx)(_.a,{children:Object(p.jsx)(y.a,{container:!0,spacing:3,children:e.map((function(e){return Object(p.jsx)(y.a,{item:!0,xs:12,md:6,lg:4,children:Object(p.jsx)(v,{wine:e})},e.id)}))})})})},E=t(18),R=t(15),C=function(e){return{type:"SET_ERRORS",payload:e}},W=function(){return{type:"CLEAR_ERRORS"}},I=function(e,n){return function(t){fetch("/wines",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(e)}).then((function(e){e.ok?e.json().then((function(e){t({type:"ADD_WINE",payload:e}),n("/wines")})):e.json().then((function(e){console.log(e),console.log(e.errors),t(C(e))}))}))}},U=function(e,n){return function(t){fetch("/reviews",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(e)}).then((function(e){e.ok?e.json().then((function(e){var c=[].concat(Object(R.a)(n.reviews),[e]),i=Object(E.a)(Object(E.a)({},n),{},{reviews:c});console.log(i),t({type:"UPDATE_WINE",payload:i})})):e.json().then((function(e){t(C(e)),console.log(e.errors),console.log(e)}))}))}},D=function(e,n,t){return function(c){fetch("/wines/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(n)}).then((function(e){e.ok?e.json().then((function(e){console.log(e),c({type:"UPDATE_WINE",payload:e}),t("/wines")})):e.json().then((function(e){c(C(e))}))}))}},k=function(e,n,t,c,i){return function(r){fetch("/reviews/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(n)}).then((function(e){e.ok?e.json().then((function(e){var n=Object(R.a)(t).find((function(n){return n.id===e.wine.id})),a=n.reviews.find((function(n){return n.id===e.id})),o=n.reviews.indexOf(a);delete e.wine,n.reviews.splice(o,1,e),r({type:"UPDATE_WINE",payload:n}),i("/wines/".concat(c))})):e.json().then((function(e){console.log(e),r(C(e))}))}))}},A=t(219),N=t(220),T=t(214),L=t(228);var q=function(){var e=Object(s.n)(),n=Object(l.b)(),t=Object(l.c)((function(e){return e.usersReducer})),c=t.currentUser,i=Object(l.c)((function(e){return e.usersReducer})),r=i.loggedIn;console.log("logged in ? ".concat(r));var a=r?Object(p.jsx)(w.a,{sx:{flexGrow:1},children:Object(p.jsx)(A.a,{children:Object(p.jsxs)(N.a,{children:[Object(p.jsx)(g.a,{size:"large",edge:"start",color:"inherit","aria-label":"menu",sx:{mr:2}}),Object(p.jsx)(O.a,{variant:"h6",component:"div",sx:{flexGrow:1},children:"\ud83c\udf77Fanatic"}),Object(p.jsx)(O.a,{variant:"h6",component:"div",sx:{flexGrow:1},children:Object(p.jsxs)(L.a,{direction:"row",spacing:2,children:[Object(p.jsx)(T.a,{color:"inherit",onClick:function(){n(W()),e("/wines")},children:"Wines"}),Object(p.jsx)(T.a,{color:"inherit",onClick:function(){n(W()),e("/add_wine")},children:"add wine"}),Object(p.jsx)(T.a,{color:"inherit",onClick:function(){n(W()),e("/cellars/".concat(c.id))},children:"my cellar"}),Object(p.jsx)(T.a,{color:"inherit",onClick:function(){n(W()),e("/users")},children:"Friends"})]})}),Object(p.jsx)(T.a,{color:"inherit",onClick:function(){n(W()),fetch("/logout",{method:"DELETE"}),n({type:"LOGOUT_USER"}),e("/login")},children:"Logout"})]})})}):Object(p.jsx)(w.a,{sx:{flexGrow:1},children:Object(p.jsx)(A.a,{children:Object(p.jsxs)(N.a,{children:[Object(p.jsx)(g.a,{size:"large",edge:"start",color:"inherit","aria-label":"menu",sx:{mr:2}}),Object(p.jsx)(O.a,{variant:"h6",component:"div",sx:{flexGrow:1},children:"\ud83c\udf77Fanatic"}),Object(p.jsx)(O.a,{variant:"h6",component:"div",sx:{flexGrow:1}}),Object(p.jsx)(T.a,{color:"inherit",onClick:function(){n(W()),e("/signin")},children:"Sign up"}),Object(p.jsx)(T.a,{color:"inherit",onClick:function(){n(W()),e("/login")},children:"Login"})]})})});return Object(p.jsx)("div",{children:a})},P=function(e,n,t){return function(c){fetch("/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:n})}).then((function(e){e.ok?e.json().then((function(e){console.log(e),c({type:"LOGIN_USER",payload:e}),t("/wines")})):e.json().then((function(e){c(C(e)),console.log(e.errors)}))}))}},G=function(e,n){return function(t){fetch("/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){e.ok?e.json().then((function(e){t({type:"ADD_USER",payload:e}),t({type:"LOGIN_USER",payload:e}),n("/wines")})):e.json().then((function(e){console.log(e),console.log(e.age);var n=[];void 0!==e.age&&n.push("age : ".concat(e.age)),void 0!==e.username&&n.push("username : ".concat(e.username)),void 0!==e.location&&n.push("location : ".concat(e.location)),void 0!==e.favorite_varietal&&n.push("varietal : ".concat(e.favorite_varietal)),void 0!==e.password&&n.push("password : ".concat(e.password)),void 0!==e.password_confirmation&&n.push("password_confirmation : ".concat(e.password_confirmation)),console.log(n),t(C(n))}))}))}},F=t(215),J=t(209),B=t(216),V=t(211);function H(){var e=Object(c.useState)(""),n=Object(o.a)(e,2),t=n[0],i=n[1],r=Object(c.useState)(""),a=Object(o.a)(r,2),j=a[0],u=a[1],d=Object(l.c)((function(e){return e.errorsReducer})),b=d.errors,h=Object(s.n)(),g=Object(l.b)();return console.log(b),Object(p.jsx)(w.a,{m:3,children:Object(p.jsx)("form",{onSubmit:function(e){e.preventDefault(),g(W()),console.log("log in submited"),g(P(j,t,h))},children:Object(p.jsx)("div",{children:Object(p.jsx)(y.a,{children:Object(p.jsxs)(F.a,{elevation:10,style:{padding:20,height:"70vh",width:280,margin:"20px auto"},children:[Object(p.jsxs)(y.a,{align:"center",children:[Object(p.jsx)("h1",{children:"\ud83d\udd12"}),Object(p.jsx)("h2",{children:"Please Login"})]}),Object(p.jsx)(J.a,{label:"Username",placeholder:"Enter username",fullWidth:!0,required:!0,onChange:function(e){return u(e.target.value)}}),Object(p.jsx)(J.a,{label:"Password",placeholder:"Enter password",type:"password",fullWidth:!0,required:!0,onChange:function(e){return i(e.target.value)}}),Object(p.jsx)(T.a,{type:"submit",color:"primary",variant:"contained",style:{margin:"8px 0"},fullWidth:!0,children:"Log in"}),Object(p.jsxs)(O.a,{children:[" Don't have an account?",Object(p.jsx)(B.a,{href:"/signin",children:"Sign Up"})]}),Object(p.jsx)("div",{children:b&&b.length>0&&Object(p.jsx)(V.a,{severity:"warning",children:b})})]})})})})})}function z(){var e=Object(c.useState)(""),n=Object(o.a)(e,2),t=n[0],i=n[1],r=Object(c.useState)(""),a=Object(o.a)(r,2),j=a[0],u=a[1],d=Object(c.useState)(""),b=Object(o.a)(d,2),h=b[0],g=b[1],f=Object(c.useState)(""),x=Object(o.a)(f,2),m=x[0],v=x[1],_=Object(c.useState)(""),S=Object(o.a)(_,2),E=S[0],R=S[1],C=Object(c.useState)(""),I=Object(o.a)(C,2),U=I[0],D=I[1],k=Object(s.n)(),A=Object(l.b)(),N=Object(l.c)((function(e){return e.errorsReducer})),L=N.errors;console.log(L);var q=L&&L.map((function(e){return Object(p.jsx)("li",{children:e})}));return Object(p.jsx)(w.a,{m:3,children:Object(p.jsx)("form",{onSubmit:function(e){e.preventDefault(),A(W()),console.log("sgn in submited"),A(G({username:j,age:h,location:m,favorite_varietal:E,password:t,password_confirmation:U},k))},children:Object(p.jsx)("div",{children:Object(p.jsx)(y.a,{children:Object(p.jsxs)(F.a,{elevation:10,style:{padding:20,height:"100vh",width:280,margin:"20px auto"},children:[Object(p.jsxs)(y.a,{align:"center",children:[Object(p.jsx)("h1",{children:"\ud83d\udd12"}),Object(p.jsx)("h2",{children:"Please Sign up"})]}),Object(p.jsx)(J.a,{label:"Username",placeholder:"Enter username",fullWidth:!0,required:!0,onChange:function(e){return u(e.target.value)}}),Object(p.jsx)(J.a,{label:"Age",placeholder:"Enter age",fullWidth:!0,required:!0,onChange:function(e){return g(e.target.value)}}),Object(p.jsx)(J.a,{label:"Location",placeholder:"Enter location",fullWidth:!0,required:!0,onChange:function(e){return v(e.target.value)}}),Object(p.jsx)(J.a,{label:"Favorite varietal",placeholder:"Enter favorite varietal",fullWidth:!0,required:!0,onChange:function(e){return R(e.target.value)}}),Object(p.jsx)(J.a,{label:"Password",placeholder:"Enter password",type:"password",fullWidth:!0,required:!0,onChange:function(e){return i(e.target.value)}}),Object(p.jsx)(J.a,{label:"Password confirmation",placeholder:"Enter password confirmation",type:"password",fullWidth:!0,required:!0,onChange:function(e){return D(e.target.value)}}),Object(p.jsx)(T.a,{type:"submit",color:"primary",variant:"contained",style:{margin:"8px 0"},fullWidth:!0,children:"Sign in"}),Object(p.jsxs)(O.a,{children:[" Do you have an account ?",Object(p.jsx)(B.a,{href:"/login",children:"Log in"})]}),q&&q.length>0&&Object(p.jsx)(V.a,{severity:"warning",children:q})]})})})})})}var Q=t(3),M=t(229),K=t(217),X=t(116),Y=t.n(X),Z=t(115),$=t.n(Z),ee=t(53),ne=t(113),te=t.n(ne),ce=t(114),ie=t.n(ce),re=t(207);function ae(e){var n=e.wineObj,t=e.rev,c=Object(s.n)(),i=Object(l.b)();console.log(n),console.log(t),console.log(t.user_id);var r=Object(l.c)((function(e){return e.usersReducer})),a=r.currentUser;console.log(a),console.log(a.id);var o=t.username.charAt(0).toUpperCase();console.log(o);var b=a.id===t.user_id?Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)(L.a,{direction:"row",spacing:2,children:[Object(p.jsx)(h.a,{title:"edit review",children:Object(p.jsx)(g.a,{"aria-label":"edit review",onClick:function(){return e=t.id,r=n.id,console.log(e),console.log(r),i(W()),void c("/edit_review",{state:{id:e,wine_id:r}});var e,r},children:Object(p.jsx)(te.a,{})})}),Object(p.jsx)(h.a,{title:"delete review",children:Object(p.jsx)(g.a,{"aria-label":"delete review",onClick:function(){return function(e){console.log(e),i(W()),fetch("/reviews/".concat(e),{method:"DELETE"});var t=n.reviews.filter((function(n){return n.id!==e})),c=Object(E.a)(Object(E.a)({},n),{},{reviews:t});i({type:"UPDATE_WINE",payload:c})}(t.id)},children:Object(p.jsx)(ie.a,{})})})]})}):null;return Object(p.jsx)(w.a,{m:5,sx:{display:"flex",justifyContent:"center"},children:Object(p.jsxs)(j.a,{elevation:2,children:[Object(p.jsx)(w.a,{sx:{display:"flex",flexDirection:"column",justifyContent:"space-between"},children:Object(p.jsx)(M.a,{avatar:Object(p.jsx)(K.a,{sx:{bgcolor:re.a[200]},"aria-label":"review",children:o}),action:Object(p.jsx)(u.a,{disableSpacing:!0,sx:{mt:"auto",display:"flex",justifyContent:"flex-end"},children:b}),title:t.username})}),Object(p.jsx)(d.a,{children:Object(p.jsx)(O.a,{variant:"body2",color:"textSecondary",children:t.comment})})]})})}var oe=t(117),le=t.n(oe);function se(){var e=Object(c.useState)(!1),n=Object(o.a)(e,2),t=n[0],i=n[1],r=Object(c.useState)(!0),a=Object(o.a)(r,2),f=a[0],x=a[1],m=Object(c.useState)(""),v=Object(o.a)(m,2),_=v[0],S=v[1],R=Object(s.n)(),C=Object(l.c)((function(e){return e.errorsReducer})),I=C.errors,D=Object(l.c)((function(e){return e.winesReducer})),k=Object(l.c)((function(e){return e.usersWinesReducer})),A=Object(l.c)((function(e){return e.usersReducer})),N=A.currentUser;console.log(N),console.log(N.id),console.log(D),console.log(k),console.log(I);var q=Object(l.b)(),P=parseInt(Object(s.p)().id),G=D.find((function(e){return e.id===P}));console.log(G);var F=G.author.username.charAt(0).toUpperCase();console.log(F);var J=G.reviews.map((function(e){return Object(p.jsx)(ae,{rev:e,wineObj:G},e.id)})),B=t?Object(p.jsx)(g.a,{"aria-label":"write a review",onClick:function(){console.log("chat btn clicked"),x(!0),console.log(f),i(!1),console.log(t)},children:Object(p.jsx)($.a,{})}):null;function H(){x(!1),S(""),q(W()),i(!0)}var z=N.id===G.user_id?Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(h.a,{title:"Edit post",children:Object(p.jsx)(g.a,{"aria-label":"edit",onClick:function(){return e=G.id,console.log(e),void R("/edit_wine",{state:{id:e}});var e},children:Object(p.jsx)(Y.a,{})})})}):null,X=f?Object(p.jsxs)("form",{action:"/html/tags/html_form_tag_action.cfm",method:"post",onSubmit:function(e){e.preventDefault(),q(W()),console.log("review submitted");var n={comment:_.comment,user_id:N.id,wine_id:P};q(U(n,G)),H()},children:[Object(p.jsx)("textarea",{name:"comment",value:_.comment,onChange:function(e){S(Object(E.a)(Object(E.a)({},_),{},Object(Q.a)({},e.target.name,e.target.value)))},style:{width:"100%",height:"90px",padding:"2%",font:"1.4em/1.6em cursive",backgroundcolor:"gold",color:"green"}}),I&&I.length>0&&Object(p.jsx)(V.a,{severity:"warning",children:I}),Object(p.jsx)(T.a,{type:"submit",color:"primary",children:"submit"}),Object(p.jsx)(T.a,{color:"primary",onClick:H,type:"button",children:"cancel"})]}):null;return Object(p.jsxs)(w.a,{m:10,children:[Object(p.jsxs)(j.a,{sx:{maxWidth:750,display:"flex",margin:"auto",flexDirection:"column",justifyContent:"flex-end"},children:[Object(p.jsx)(M.a,{avatar:Object(p.jsx)(K.a,{sx:{bgcolor:ee.a[500]},"aria-label":"recipe",children:F}),action:Object(p.jsx)(u.a,{disableSpacing:!0,sx:{mt:"auto",display:"flex",justifyContent:"flex-end"},children:z}),title:G.author.username}),Object(p.jsxs)("div",{children:[Object(p.jsx)(b.a,{component:"img",style:{height:200,width:350,float:"left"},image:G.img_url,alt:"wine bottle"}),Object(p.jsxs)(d.a,{style:{float:"right",width:350},children:[Object(p.jsx)(O.a,{gutterBottom:!0,variant:"h5",component:"div",children:G.winery}),Object(p.jsx)(O.a,{gutterBottom:!0,variant:"h5",component:"div",children:G.name}),Object(p.jsx)(O.a,{variant:"body2",color:"text.secondary",children:G.region})]})]}),Object(p.jsxs)(u.a,{disableSpacing:!0,sx:{mt:"auto"},children:[Object(p.jsx)(w.a,{sx:{display:"flex",justifyContent:"flex-end",alignItems:"flex-end"},children:Object(p.jsx)(h.a,{title:"add to cellar",children:Object(p.jsx)(g.a,{"aria-label":"add to cellar",onClick:function(){return function(e){console.log("edit clicked"),R("/add_to_cellar",{state:{wineId:e}})}(P)},children:Object(p.jsx)(le.a,{})})})}),Object(p.jsx)(L.a,{direction:"row",spacing:2,style:{float:"right"},children:Object(p.jsx)(h.a,{title:"write reviews",children:B})})]})]}),Object(p.jsx)(y.a,{children:X}),Object(p.jsx)(y.a,{container:!0,spacing:3,sx:{display:"flex",justifyContent:"center"},children:Object(p.jsx)("li",{children:J})})]})}var je={name:"",winery:"",vintage:"",region:"",grape:"",wine_type:"",img_url:""};function ue(e){var n=e.loading,t=Object(c.useState)(je),i=Object(o.a)(t,2),r=i[0],a=i[1],j=Object(l.c)((function(e){return e.winesReducer}));console.log(j);var u=Object(l.c)((function(e){return e.usersReducer})),d=u.currentUser,b=u.loggedIn,O=Object(l.c)((function(e){return e.errorsReducer})),h=O.errors,g=Object(l.b)(),f=Object(s.n)(),x=Object(s.l)();console.log(x.state);var m=x.state.id;function v(e){a(Object(E.a)(Object(E.a)({},r),{},Object(Q.a)({},e.target.name,e.target.value)))}console.log(m),Object(c.useEffect)((function(){n||b||f("/login");var e=j.find((function(e){return e.id===parseInt(m)}));console.log(e),d.id!==e.user_id&&f("/wines"),a({name:e.name,winery:e.winery,vintage:e.vintage,region:e.region,grape:e.grape,wine_type:e.wine_type,img_url:e.img_url})}),[j,n,b,d,m,f]);return Object(p.jsx)(w.a,{m:15,children:Object(p.jsxs)("form",{onSubmit:function(e){e.preventDefault(),g(W()),g(D(m,r,f)),a(je)},children:[Object(p.jsx)(J.a,{fullWidth:!0,id:"name",name:"name",label:"Name",value:r.name,onChange:v}),"\xa0",Object(p.jsx)(J.a,{fullWidth:!0,id:"winery",name:"winery",label:"Winery",value:r.winery,onChange:v}),"\xa0",Object(p.jsx)(J.a,{fullWidth:!0,id:"vintage",name:"vintage",label:"Vintage",value:r.vintage,onChange:v}),"\xa0",Object(p.jsx)(J.a,{fullWidth:!0,id:"region",name:"region",label:"Region",value:r.region,onChange:v}),"\xa0",Object(p.jsx)(J.a,{fullWidth:!0,id:"grape",name:"grape",label:"Grape",value:r.grape,onChange:v}),"\xa0",Object(p.jsx)(J.a,{fullWidth:!0,id:"wine_type",name:"wine_type",label:"Wine Type",value:r.wine_type,onChange:v}),"\xa0",Object(p.jsx)(J.a,{fullWidth:!0,id:"img_url",name:"img_url",label:"Image URL",value:r.img_url,onChange:v}),h&&h.length>0&&Object(p.jsx)(V.a,{severity:"warning",children:h}),Object(p.jsx)(T.a,{color:"primary",variant:"contained",type:"submit",children:"Submit"}),"\xa0",Object(p.jsx)(T.a,{color:"primary",variant:"contained",type:"button",onClick:function(){f(-1),g(W())},children:"cancel"})]})})}var de=t(206),be={comment:"",wine_id:"",user_id:""};function Oe(){var e=Object(c.useState)(be),n=Object(o.a)(e,2),t=n[0],i=n[1],r=Object(l.c)((function(e){return e.winesReducer}));console.log(r);var a=Object(l.c)((function(e){return e.usersReducer})),j=a.currentUser,u=a.loggedIn,d=Object(l.c)((function(e){return e.errorsReducer})),b=d.errors,O=Object(s.n)(),h=Object(s.l)(),g=Object(l.b)();console.log(h.state);var f=h.state.id,x=h.state.wine_id;console.log(f),console.log(x),Object(c.useEffect)((function(){u||O("/login");var e=r.find((function(e){return e.id===parseInt(x)})).reviews.find((function(e){return e.id===parseInt(f)}));j.id!==e.user_id&&O("/wines"),i({comment:e.comment,wine_id:e.wine_id,user_id:e.user_id})}),[r,u,j,f,x,O]);return Object(p.jsx)(w.a,{m:15,children:Object(p.jsxs)("form",{action:"/html/tags/html_form_tag_action.cfm",method:"post",onSubmit:function(e){e.preventDefault(),g(W()),console.log("review form submited "),g(k(f,t,r,x,O)),i(be)},children:[Object(p.jsx)(de.a,{name:"comment",value:t.comment,onChange:function(e){i(Object(E.a)(Object(E.a)({},t),{},Object(Q.a)({},e.target.name,e.target.value)))},style:{width:"96%",height:"90px",padding:"2%",fontSize:"1.4em",lineHeight:"1.6em",backgroundColor:"light grey",color:"green"}}),b&&b.length>0&&Object(p.jsx)(V.a,{severity:"warning",children:b}),Object(p.jsx)(T.a,{variant:"contained",color:"primary",type:"submit",children:"Submit"}),"\xa0",Object(p.jsx)(T.a,{variant:"contained",color:"primary",onClick:function(){O(-1),g(W())},children:"Cancel"})]})})}var he={name:"",winery:"",vintage:"",region:"",grape:"",wine_type:"",img_url:""};function ge(){var e=Object(c.useState)(he),n=Object(o.a)(e,2),t=n[0],i=n[1],r=Object(l.c)((function(e){return e.errorsReducer})),a=r.errors,j=Object(s.n)(),u=Object(l.b)();function d(e){i(Object(E.a)(Object(E.a)({},t),{},Object(Q.a)({},e.target.name,e.target.value))),console.log(t)}var b=a&&a.map((function(e){return Object(p.jsx)("li",{children:e})}));return Object(p.jsx)(w.a,{m:15,children:Object(p.jsxs)("form",{onSubmit:function(e){e.preventDefault(),u(W()),console.log(t),u(I(t,j)),i(he)},children:[Object(p.jsx)(J.a,{fullWidth:!0,id:"name",name:"name",label:"Name",value:t.name,onChange:d}),"\xa0",Object(p.jsx)(J.a,{fullWidth:!0,id:"winery",name:"winery",label:"Winery",value:t.winery,onChange:d}),"\xa0",Object(p.jsx)(J.a,{fullWidth:!0,id:"vintage",name:"vintage",label:"Vintage",value:t.vintage,onChange:d}),"\xa0",Object(p.jsx)(J.a,{fullWidth:!0,id:"region",name:"region",label:"Region",value:t.region,onChange:d}),"\xa0",Object(p.jsx)(J.a,{fullWidth:!0,id:"grape",name:"grape",label:"Grape",value:t.grape,onChange:d}),"\xa0",Object(p.jsx)(J.a,{fullWidth:!0,id:"wine_type",name:"wine_type",label:"Wine Type",value:t.wine_type,onChange:d}),"\xa0",Object(p.jsx)(J.a,{fullWidth:!0,id:"img_url",name:"img_url",label:"Image URL",value:t.img_url,onChange:d}),Object(p.jsx)(T.a,{color:"primary",variant:"contained",type:"submit",children:"Submit"}),"\xa0",Object(p.jsx)(T.a,{color:"primary",variant:"contained",type:"button",onClick:function(){j(-1),u(W())},children:"cancel"}),b&&b.length>0&&Object(p.jsx)(V.a,{severity:"warning",children:b})]})})}var fe=t(118),xe=t.n(fe);function me(e){var n=e.user,t=Object(l.c)((function(e){return e.usersReducer})),c=t.currentUser;console.log(c),console.log(n),console.log(c.id);var i=n.username.charAt(0).toUpperCase();console.log(i);var r=c.id===n.id?Object(p.jsx)(p.Fragment,{}):null;return Object(p.jsxs)(j.a,{sx:{maxWidth:345},children:[Object(p.jsx)(M.a,{avatar:Object(p.jsx)(K.a,{sx:{bgcolor:ee.a[700]},"aria-label":"recipe",children:i}),action:Object(p.jsx)(u.a,{children:r}),title:n.username,subheader:n.age}),Object(p.jsxs)(d.a,{children:[Object(p.jsxs)(O.a,{gutterBottom:!0,variant:"body2",component:"div",children:["Favorite Varietal :  ",n.favorite_varietal]}),Object(p.jsxs)(O.a,{variant:"body2",color:"text.secondary",children:["Location : ",n.location]})]}),Object(p.jsx)(u.a,{disableSpacing:!0,children:Object(p.jsx)(m.b,{to:"/cellars/".concat(n.id),children:Object(p.jsx)(h.a,{title:"view this cellar",children:Object(p.jsx)(g.a,{"aria-label":"add to favorites",children:Object(p.jsx)(xe.a,{})})})})})]})}function pe(){var e=Object(l.c)((function(e){return e.usersReducer})),n=e.users;return console.log(n),Object(p.jsx)(w.a,{m:10,children:Object(p.jsx)(_.a,{children:Object(p.jsx)(y.a,{container:!0,spacing:3,children:n.map((function(e){return Object(p.jsx)(y.a,{item:!0,xs:12,md:6,lg:4,children:Object(p.jsx)(me,{user:e})},e.id)}))})})})}var ve=t(120),ye=t.n(ve),we=t(119),_e=t.n(we);function Se(e){var n=e.wine,t=e.filteredUsersWines,c=Object(l.c)((function(e){return e.usersReducer})),i=c.currentUser,r=Object(l.c)((function(e){return e.usersWinesReducer}));console.log(r);var a=Object(l.b)(),o=Object(s.n)();console.log(n);var f=t.filter((function(e){return e.wine_id===n.id})),v=f.map((function(e){return e.id}));console.log("users_wines.id",v);var w=f.map((function(e){return e.user_id}));console.log("users_wines.user_id",w),console.log(parseInt(w)),console.log(i.id),console.log(t);var _=parseInt(w)===i.id?Object(p.jsxs)(y.a,{children:[Object(p.jsx)(h.a,{title:"change amount in stock",children:Object(p.jsx)(g.a,{"aria-label":"change stock amount",onClick:function(){return e=n.id,console.log("edit clicked"),console.log("wine id",e),void o("/edit_userswine",{state:{wineId:e,userId:w}});var e},children:Object(p.jsx)(_e.a,{})})}),Object(p.jsx)(h.a,{title:"remove from cellar",children:Object(p.jsx)(g.a,{"aria-label":"remover from cellar",onClick:function(){return e=parseInt(v),console.log(e),fetch("/users_wines/".concat(e),{method:"DELETE"}),void a({type:"DELETE_USERS_WINES",payload:e});var e},children:Object(p.jsx)(ye.a,{})})})]}):null;return Object(p.jsxs)(j.a,{sx:{maxWidth:345},children:[Object(p.jsx)(b.a,{sx:{height:300},image:n.img_url,title:"wine bottle",style:{width:"90%",float:"center"}}),Object(p.jsxs)(d.a,{children:[Object(p.jsx)(O.a,{gutterBottom:!0,variant:"h5",component:"div",children:n.name}),Object(p.jsx)(O.a,{variant:"body2",color:"text.secondary",children:n.region}),Object(p.jsxs)(O.a,{gutterBottom:!0,variant:"body1",color:"text.secondary",style:{color:"red"},children:[n.quantity," in stock"]})]}),Object(p.jsxs)(u.a,{children:[Object(p.jsx)(m.b,{to:"/wines/".concat(n.id),children:Object(p.jsx)(h.a,{title:"see reviews",children:Object(p.jsx)(g.a,{"aria-label":"see reviews",children:Object(p.jsx)(x.a,{})})})}),_]})]})}function Ee(){var e=Object(l.c)((function(e){return e.usersReducer})),n=e.users;console.log(n);var t=Object(l.c)((function(e){return e.winesReducer}));console.log(t);var c=Object(l.c)((function(e){return e.usersWinesReducer}));console.log(c);var i=parseInt(Object(s.p)().id),r=n.find((function(e){return e.id===i}));console.log(r);var a=c.filter((function(e){return e.user_id===i}));console.log(a);var o=t.filter((function(e){return a.some((function(n){return n.wine_id===e.id}))}));console.log(o);var j=o.map((function(e){return Object(E.a)(Object(E.a)({},e),{},{quantity:a.find((function(n){return n.wine_id===e.id})).quantity})}));return console.log(j),Object(p.jsxs)(w.a,{m:10,children:[Object(p.jsx)(y.a,{children:Object(p.jsxs)(O.a,{variant:"body2",style:{color:"red"},children:[r.username,"'s cellar"]})}),"\xa0",Object(p.jsx)(_.a,{children:Object(p.jsx)(y.a,{container:!0,spacing:3,children:j.map((function(e){return Object(p.jsx)(y.a,{item:!0,xs:12,md:6,lg:4,children:Object(p.jsx)(Se,{wine:e,filteredUsersWines:a})},e.id)}))})})]})}var Re=function(e,n,t,c){return function(c){var i={wine_id:e};console.log(e),console.log(i),fetch("/users_wines",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(i)}).then((function(e){e.ok?e.json().then((function(e){console.log(e),c({type:"ADD_USERS_WINES",payload:e}),n("/cellars/".concat(t.id))})):e.json().then((function(e){c(C(e)),console.log(e)}))}))}},Ce=function(e,n,t,c,i){return function(t){console.log(n),console.log(e),fetch("/users_wines/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(n)}).then((function(e){e.ok?e.json().then((function(e){console.log(n),t({type:"UPDATE_USER_WINES",payload:e}),i("/cellars/".concat(c.id))})):e.json().then((function(e){t(C(e))}))}))}},We={name:"",vintage:"",region:""},Ie={quantity:""};function Ue(e){e.loading;var n=Object(c.useState)(Ie),t=Object(o.a)(n,2),i=t[0],r=t[1],a=Object(c.useState)(We),j=Object(o.a)(a,2),u=j[0],d=j[1],b=Object(l.c)((function(e){return e.errorsReducer})),O=b.errors,h=Object(l.c)((function(e){return e.usersReducer})),g=h.users,f=Object(l.c)((function(e){return e.winesReducer})),x=Object(l.c)((function(e){return e.usersReducer})),m=x.currentUser,v=Object(l.c)((function(e){return e.usersWinesReducer})),y=Object(s.n)(),_=Object(l.b)(),S=Object(s.l)();console.log(S.state);var R=S.state.wineId;console.log("wine id ",R);var C=S.state.userId;console.log(C),console.log(g),console.log(m),Object(c.useEffect)((function(){var e=f.find((function(e){return e.id===parseInt(R)}));console.log("wine in the form ",e),d({name:e.name,vintage:e.vintage,region:e.region})}),[R,f]);var I=v.filter((function(e){return e.user_id===m.id}));console.log(I);var U=I.filter((function(e){return e.wine_id===R})).map((function(e){return{wine:f.find((function(n){return n.id===e.wine_id})),id:e.id,quantity:e.quantity}}));console.log(U),console.log("user wine id ",U[0].id),console.log("user wine quantity",U[0].quantity);var D=U[0].quantity,k=U[0].id;console.log(D),console.log(k);return Object(p.jsx)(w.a,{m:15,children:Object(p.jsxs)("form",{onSubmit:function(e){e.preventDefault(),_(W());var n={wine_id:R,quantity:parseInt(i.quantity)};console.log(n),console.log(k),_(Ce(k,n,g,m,y))},children:[Object(p.jsx)(J.a,{fullWidth:!0,id:"name",name:"name",label:"Name",value:u.name,disabled:!0}),"\xa0",Object(p.jsx)(J.a,{fullWidth:!0,id:"vintage",name:"vintage",label:"Vintage",value:u.vintage,disabled:!0}),"\xa0",Object(p.jsx)(J.a,{fullWidth:!0,id:"region",name:"region",label:"Region",value:u.region,disabled:!0}),"\xa0",Object(p.jsx)(J.a,{fullWidth:!0,id:"old_quantiy",name:"old_quantity",label:"Quantity",value:D,disabled:!0}),"\xa0",Object(p.jsx)(J.a,{fullWidth:!0,id:"quantity",name:"quantity",label:"Enter New Quantity",value:i.quantity,onChange:function(e){r(Object(E.a)(Object(E.a)({},i),{},Object(Q.a)({},e.target.name,e.target.value))),console.log(i)}}),Object(p.jsx)(T.a,{color:"primary",variant:"contained",type:"submit",children:"Submit"}),"\xa0",Object(p.jsx)(T.a,{color:"primary",variant:"contained",type:"button",onClick:function(){y(-1),_(W())},children:"cancel"}),O&&O.length>0&&Object(p.jsx)(V.a,{severity:"warning",children:O})]})})}var De={name:"",vintage:"",region:""};function ke(e){var n=e.loading,t=Object(l.c)((function(e){return e.usersReducer})),i=t.loggedIn,r=Object(c.useState)(De),a=Object(o.a)(r,2),j=a[0],u=a[1],d=Object(l.c)((function(e){return e.errorsReducer})),b=d.errors,O=Object(l.c)((function(e){return e.usersReducer})),h=O.users,g=Object(l.c)((function(e){return e.usersReducer})),f=g.currentUser,x=Object(l.c)((function(e){return e.winesReducer})),m=Object(s.n)(),v=Object(l.b)(),y=Object(s.l)();console.log(y.state);var _=y.state.wineId;console.log("wine id ",_),console.log(b),Object(c.useEffect)((function(){n||i||m("/login");var e=x.find((function(e){return e.id===parseInt(_)}));console.log("wine in the form ",e),u({name:e.name,vintage:e.vintage,region:e.region})}),[n,i,m,_,x]);return Object(p.jsx)(w.a,{m:15,children:Object(p.jsxs)("form",{onSubmit:function(e){e.preventDefault(),v(W()),v(Re(_,m,f,h))},children:[Object(p.jsx)(J.a,{fullWidth:!0,id:"name",name:"name",label:"Name",value:j.name,disabled:!0}),"\xa0",Object(p.jsx)(J.a,{fullWidth:!0,id:"vintage",name:"vintage",label:"Vintage",value:j.vintage,disabled:!0}),"\xa0",Object(p.jsx)(J.a,{fullWidth:!0,id:"region",name:"region",label:"Region",value:j.region,disabled:!0}),Object(p.jsx)(T.a,{color:"primary",variant:"contained",type:"submit",children:"add to cellar"}),"\xa0",Object(p.jsx)(T.a,{color:"primary",variant:"contained",type:"button",onClick:function(){m(-1),v(W())},children:"cancel"}),b&&b.length>0&&Object(p.jsx)(V.a,{severity:"warning",children:b})]})})}var Ae=t.p+"static/media/wineglasses.71fede56.jpg";function Ne(){return Object(p.jsx)(w.a,{m:8,children:Object(p.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:Object(p.jsxs)("div",{children:[Object(p.jsx)("h3",{children:"Welcome to Wine-Fanatic "}),Object(p.jsx)("img",{src:Ae,style:{margin:"auto",width:"80%"},alt:"wineglasses"})]})})})}var Te=function(){var e=Object(c.useState)(!0),n=Object(o.a)(e,2),t=n[0],i=n[1],r=Object(l.b)();Object(c.useEffect)((function(){r((function(e){fetch("/wines").then((function(e){return e.json()})).then((function(n){var t={type:"LOAD_WINES",payload:n};console.log(n),e(t)}))})),r((function(e){fetch("/users_wines").then((function(e){return e.json()})).then((function(n){var t={type:"LOAD_USERS_WINES",payload:n};console.log(n),e(t)}))})),r(function(e){return function(n){fetch("/me").then((function(e){return e.json()})).then((function(t){t.ok?n({type:"LOGIN_USER",payload:t}):e(!1)}))}}(i)),r(function(e){return function(n){fetch("/users").then((function(e){return e.json()})).then((function(t){var c={type:"LOAD_USERS",payload:t};console.log(t),e(!1),n(c)}))}}(i))}),[r]),console.log(" loading ? ".concat(t));var a=t?Object(p.jsx)(p.Fragment,{children:"..."}):Object(p.jsxs)(s.c,{children:[Object(p.jsx)(s.a,{exact:!0,path:"/wines",element:Object(p.jsx)(S,{})}),Object(p.jsx)(s.a,{exact:!0,path:"/users",element:Object(p.jsx)(pe,{})}),Object(p.jsx)(s.a,{exact:!0,path:"/wines/:id",element:Object(p.jsx)(se,{})}),Object(p.jsx)(s.a,{exact:!0,path:"/cellars/:id",element:Object(p.jsx)(Ee,{})}),Object(p.jsx)(s.a,{exact:!0,path:"/add_wine",element:Object(p.jsx)(ge,{})}),Object(p.jsx)(s.a,{exact:!0,path:"/edit_wine",element:Object(p.jsx)(ue,{loading:t})}),Object(p.jsx)(s.a,{exact:!0,path:"/add_to_cellar",element:Object(p.jsx)(ke,{loading:t})}),Object(p.jsx)(s.a,{exact:!0,path:"/edit_userswine",element:Object(p.jsx)(Ue,{loading:t})}),Object(p.jsx)(s.a,{exact:!0,path:"/login",element:Object(p.jsx)(H,{})}),Object(p.jsx)(s.a,{exact:!0,path:"/signin",element:Object(p.jsx)(z,{})}),Object(p.jsx)(s.a,{exact:!0,path:"/edit_review",element:Object(p.jsx)(Oe,{})}),Object(p.jsx)(s.a,{exact:!0,path:"/",element:Object(p.jsx)(Ne,{})})]});return Object(p.jsxs)("div",{children:[Object(p.jsx)(q,{}),a]})},Le=t(47),qe=t(121),Pe=t(122),Ge=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"SET_ERRORS":return n.payload;case"CLEAR_ERRORS":return[];default:return e}},Fe={users:[],currentUser:null,loggedIn:!1},Je=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"LOAD_USERS":return Object(E.a)(Object(E.a)({},e),{},{users:n.payload});case"LOGIN_USER":return Object(E.a)(Object(E.a)({},e),{},{currentUser:n.payload,loggedIn:!0});case"ADD_USER":return Object(E.a)(Object(E.a)({},e),{},{users:[].concat(Object(R.a)(e.users),[n.payload])});case"LOGOUT_USER":return Object(E.a)(Object(E.a)({},e),{},{currentUser:Fe.currentUser,loggedIn:!1});default:return e}},Be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"LOAD_WINES":return n.payload;case"ADD_WINE":return[].concat(Object(R.a)(e),[n.payload]);case"UPDATE_WINE":return e.map((function(e){return n.payload.id===e.id?n.payload:e}));default:return e}},Ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"LOAD_USERS_WINES":return n.payload;case"ADD_USERS_WINES":return[].concat(Object(R.a)(e),[n.payload]);case"DELETE_USERS_WINES":return e.filter((function(e){return e.id!==n.payload}));case"UPDATE_USER_WINES":return e.map((function(e){return n.payload.id===e.id?n.payload:e}));default:return e}},He=Object(Le.b)({errorsReducer:Ge,usersReducer:Je,usersWinesReducer:Ve,winesReducer:Be}),ze=Object(Le.d)(He,Object(qe.a)(Object(Le.a)(Pe.a)));a.a.render(Object(p.jsx)(i.a.StrictMode,{children:Object(p.jsx)(m.a,{children:Object(p.jsx)(l.a,{store:ze,children:Object(p.jsx)(Te,{})})})}),document.getElementById("root"))}},[[153,1,2]]]);
//# sourceMappingURL=main.d13ef1e9.chunk.js.map